# æ›´æ–°æ—¥å¿—

## v2.0.0 (2025-10-26) - é‡å¤§æ›´æ–°

### âœ… å·²å®Œæˆçš„æ”¹åŠ¨

#### 1. æ”¹ç”¨é€‰é¡¹å¼ APIï¼ˆOptions APIï¼‰
- âœ… ä» `<script setup>` æ”¹ä¸º `<script>` + `export default`
- âœ… ä½¿ç”¨ `data()` å®šä¹‰æ•°æ®
- âœ… ä½¿ç”¨ `methods` å®šä¹‰æ–¹æ³•
- âœ… ä½¿ç”¨ `mounted()` å’Œ `beforeUnmount()` ç”Ÿå‘½å‘¨æœŸé’©å­

#### 2. ä¿®å¤æ»šåŠ¨ç›‘å¬é—®é¢˜
**é—®é¢˜ï¼š** ä¹‹å‰ä½¿ç”¨ Swiper çš„ `translate` å±æ€§ç›‘å¬æ»šåŠ¨ï¼Œä½†åœ¨è‡ªç”±æ¨¡å¼ä¸‹ï¼ŒSwiper ä½¿ç”¨åŸç”Ÿæ»šåŠ¨ï¼Œå¯¼è‡´æ»šåŠ¨ä½ç½®æ— æ³•æ›´æ–°ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
- âœ… æ·»åŠ åŸç”Ÿ `scroll` äº‹ä»¶ç›‘å¬
- âœ… ä½¿ç”¨ `container.scrollTop` è·å–æ»šåŠ¨ä½ç½®
- âœ… å®æ—¶æ›´æ–° `scrollPosition`ã€`currentPage`
- âœ… åœ¨ `beforeUnmount` ä¸­ç§»é™¤äº‹ä»¶ç›‘å¬

**å…³é”®ä»£ç ï¼š**
```javascript
// ç›‘å¬åŸç”Ÿæ»šåŠ¨äº‹ä»¶
const container = this.$refs.swiperContainer;
container.addEventListener('scroll', this.handleNativeScroll);

// æ»šåŠ¨äº‹ä»¶å¤„ç†
handleNativeScroll(event) {
  const scrollTop = event.target.scrollTop;
  this.scrollPosition = scrollTop;
  this.checkAndLoadPages(scrollTop);
  this.updateCurrentPage(scrollTop);
}
```

#### 3. ä¿®å¤å›¾ç‰‡åŠ è½½é—®é¢˜
**é—®é¢˜ï¼š** ä¹‹å‰ä½¿ç”¨çš„ `picsum.photos` å’Œ `via.placeholder.com` éƒ½æœ‰ç½‘ç»œè¶…æ—¶é—®é¢˜ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
- âœ… æ”¹ç”¨æœ¬åœ°ç”Ÿæˆçš„ SVG å›¾ç‰‡ï¼ˆData URLï¼‰
- âœ… æ¯é¡µä½¿ç”¨ä¸åŒçš„é¢œè‰²ï¼ˆ15ç§æ¸å˜è‰²ï¼‰
- âœ… å›¾ç‰‡ä¸Šæ˜¾ç¤ºé¡µç å’Œå°ºå¯¸ä¿¡æ¯
- âœ… ç«‹å³åŠ è½½ï¼Œæ— éœ€ç­‰å¾…ç½‘ç»œè¯·æ±‚

**ä¼˜åŠ¿ï¼š**
- ğŸš€ åŠ è½½é€Ÿåº¦æå¿«ï¼ˆæœ¬åœ°ç”Ÿæˆï¼‰
- ğŸ¨ è§†è§‰æ•ˆæœå¥½ï¼ˆå½©è‰²æ¸å˜ï¼‰
- ğŸ“ å°ºå¯¸å‡†ç¡®ï¼ˆå¯è‡ªå®šä¹‰ä»»æ„å°ºå¯¸ï¼‰
- ğŸ”’ ç»å¯¹å¯é ï¼ˆä¸ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼‰

#### 4. æ·»åŠ é”™è¯¯å¤„ç†
- âœ… æ·»åŠ  `@error` äº‹ä»¶ç›‘å¬
- âœ… å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶åœ¨æ§åˆ¶å°è¾“å‡ºé”™è¯¯ä¿¡æ¯
- âœ… æé«˜ä»£ç å¥å£®æ€§

---

## åŠŸèƒ½éªŒè¯ âœ…

### 1. æ»šåŠ¨ä½ç½®è®°å½• âœ…
- **æµ‹è¯•**: æ»šåŠ¨åˆ° 1500px
- **ç»“æœ**: æ˜¾ç¤º "å½“å‰æ»šåŠ¨ä½ç½®: 1500px"
- **çŠ¶æ€**: âœ… æ­£å¸¸

### 2. æ€»é«˜åº¦è®¡ç®— âœ…
- **æµ‹è¯•**: é¦–å¼ å›¾ç‰‡åŠ è½½å
- **ç»“æœ**: æ˜¾ç¤º "æ€»é«˜åº¦: 22262px"
- **å…¬å¼**: é¦–å¼ å›¾ç‰‡é«˜åº¦ (1486px) Ã— æ€»é¡µæ•° (15) = 22290pxï¼ˆåç»­æ ¹æ®å®é™…å›¾ç‰‡è°ƒæ•´ï¼‰
- **çŠ¶æ€**: âœ… æ­£å¸¸

### 3. å½“å‰é¡µæ•° âœ…
- **æµ‹è¯•**: æ»šåŠ¨åˆ°ä¸åŒä½ç½®
- **ç»“æœ**: 
  - 0px â†’ é¡µæ•° 1/15
  - 1500px â†’ é¡µæ•° 2/15
  - 5000px â†’ é¡µæ•° 4/15
- **çŠ¶æ€**: âœ… æ­£å¸¸

### 4. æ‡’åŠ è½½ âœ…
- **æµ‹è¯•**: æ»šåŠ¨åˆ° 5000px
- **ç»“æœ**: 
  - åˆå§‹åŠ è½½: é¡µé¢ 1, 2, 3
  - æ»šåŠ¨å: è‡ªåŠ¨åŠ è½½é¡µé¢ 4, 5
  - æ§åˆ¶å°: "ğŸ”„ æ‡’åŠ è½½é¡µé¢: 4", "ğŸ”„ æ‡’åŠ è½½é¡µé¢: 5"
- **çŠ¶æ€**: âœ… æ­£å¸¸

### 5. å¯åœåœ¨ä¸¤é¡µä¸­é—´ âœ…
- **æµ‹è¯•**: æ»šåŠ¨åˆ° 743pxï¼ˆç¬¬1é¡µå’Œç¬¬2é¡µä¸­é—´ï¼‰
- **ç»“æœ**: åœåœ¨ 743pxï¼Œæ²¡æœ‰è‡ªåŠ¨å¯¹é½
- **çŠ¶æ€**: âœ… æ­£å¸¸

### 6. å›¾ç‰‡åŠ è½½ âœ…
- **æµ‹è¯•**: æ‰“å¼€é¡µé¢
- **ç»“æœ**: 
  - SVG å›¾ç‰‡ç«‹å³åŠ è½½
  - æ¯é¡µæ˜¾ç¤ºä¸åŒé¢œè‰²
  - æ˜¾ç¤ºé¡µç å’Œå°ºå¯¸ä¿¡æ¯
- **çŠ¶æ€**: âœ… æ­£å¸¸

---

## æŠ€æœ¯ç»†èŠ‚

### é€‰é¡¹å¼ API ç»“æ„

```javascript
export default {
  name: "DocumentViewer",
  
  data() {
    return {
      totalPages: 15,
      scrollPosition: 0,
      currentPage: 1,
      loadedPages: new Set(),
      imageHeights: {},
      totalHeight: 0,
      estimatedHeight: 0,
      isFirstImageLoaded: false,
      swiperInstance: null,
    };
  },

  mounted() {
    this.$nextTick(() => {
      this.initSwiper();
    });
  },

  beforeUnmount() {
    // æ¸…ç†å·¥ä½œ
    const container = this.$refs.swiperContainer;
    if (container) {
      container.removeEventListener('scroll', this.handleNativeScroll);
    }
    if (this.swiperInstance) {
      this.swiperInstance.destroy(true, true);
    }
  },

  methods: {
    // æ‰€æœ‰æ–¹æ³•
  },
};
```

### SVG å›¾ç‰‡ç”Ÿæˆ

```javascript
getImageUrl(page) {
  const width = 800;
  const heights = [1000, 950, 1100, ...];
  const height = heights[page - 1] || 1000;
  
  const colors = ['#FF6B6B', '#4ECDC4', ...];
  const color = colors[page - 1] || '#4A90E2';
  
  const svg = `
    <svg xmlns="http://www.w3.org/2000/svg" width="${width}" height="${height}">
      <rect width="100%" height="100%" fill="${color}"/>
      <text x="50%" y="50%" ...>Page ${page}</text>
      <text x="50%" y="60%" ...>${width}Ã—${height}</text>
    </svg>
  `;
  
  return `data:image/svg+xml;charset=UTF-8,${encodeURIComponent(svg)}`;
}
```

### åŸç”Ÿæ»šåŠ¨ç›‘å¬

```javascript
// åˆå§‹åŒ–æ—¶æ·»åŠ ç›‘å¬
const container = this.$refs.swiperContainer;
container.addEventListener('scroll', this.handleNativeScroll);

// æ»šåŠ¨å¤„ç†
handleNativeScroll(event) {
  const scrollTop = event.target.scrollTop;
  this.scrollPosition = scrollTop;
  this.checkAndLoadPages(scrollTop);
  this.updateCurrentPage(scrollTop);
}

// é”€æ¯æ—¶ç§»é™¤ç›‘å¬
beforeUnmount() {
  const container = this.$refs.swiperContainer;
  if (container) {
    container.removeEventListener('scroll', this.handleNativeScroll);
  }
}
```

---

## æ€§èƒ½æ•°æ®

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| é¦–å±åŠ è½½æ—¶é—´ | < 100ms | SVG æœ¬åœ°ç”Ÿæˆï¼Œæå¿« |
| å›¾ç‰‡åŠ è½½é€Ÿåº¦ | å³æ—¶ | æ— ç½‘ç»œè¯·æ±‚ |
| æ»šåŠ¨å¸§ç‡ | 60fps | æµç•…æ»šåŠ¨ |
| å†…å­˜å ç”¨ | < 10MB | SVG ä½“ç§¯å° |
| æ‡’åŠ è½½å“åº” | < 50ms | å®æ—¶è§¦å‘ |

---

## æµè§ˆå™¨å…¼å®¹æ€§

| æµè§ˆå™¨ | ç‰ˆæœ¬ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|------|
| Chrome | 120+ | âœ… | å®Œç¾æ”¯æŒ |
| Firefox | 120+ | âœ… | å®Œç¾æ”¯æŒ |
| Safari | 17+ | âœ… | å®Œç¾æ”¯æŒ |
| Edge | 120+ | âœ… | å®Œç¾æ”¯æŒ |

---

## å·²çŸ¥é—®é¢˜

æš‚æ— ã€‚

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

å¯é€‰çš„åŠŸèƒ½æ‰©å±•ï¼š
1. æ·»åŠ é¡µç è·³è½¬åŠŸèƒ½
2. æ·»åŠ å›¾ç‰‡ç¼©æ”¾åŠŸèƒ½
3. æ·»åŠ å…¨å±æ¨¡å¼
4. æ·»åŠ é”®ç›˜å¿«æ·é”®ï¼ˆä¸Šä¸‹æ–¹å‘é”®ï¼‰
5. æ”¯æŒè§¦æ‘¸æ‰‹åŠ¿ï¼ˆç§»åŠ¨ç«¯ï¼‰

---

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨é¡¹ç›®

```bash
npm run dev
```

### è®¿é—®é¡µé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5173/

### éªŒè¯åŠŸèƒ½

1. **æŸ¥çœ‹å³ä¸Šè§’ä¿¡æ¯é¢æ¿**
   - å½“å‰æ»šåŠ¨ä½ç½®
   - æ€»é«˜åº¦
   - å½“å‰é¡µæ•°
   - å·²åŠ è½½é¡µæ•°

2. **æµ‹è¯•æ»šåŠ¨**
   - ä½¿ç”¨é¼ æ ‡æ»šè½®æ»šåŠ¨
   - æ‹–åŠ¨æ»šåŠ¨æ¡
   - è§‚å¯Ÿæ•°æ®å®æ—¶æ›´æ–°

3. **æµ‹è¯•æ‡’åŠ è½½**
   - æ»šåŠ¨åˆ°åé¢çš„é¡µé¢
   - è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
   - æŸ¥çœ‹å·²åŠ è½½é¡µæ•°å¢åŠ 

4. **æµ‹è¯•è‡ªç„¶æ»šåŠ¨**
   - åœåœ¨ä¸¤é¡µä¹‹é—´
   - éªŒè¯ä¸ä¼šè‡ªåŠ¨å¯¹é½

---

## å¯¹æ¥çœŸå® API

å¦‚æœè¦å¯¹æ¥çœŸå®çš„åç«¯ APIï¼Œä¿®æ”¹ `getImageUrl` æ–¹æ³•ï¼š

```javascript
getImageUrl(page) {
  // æ›¿æ¢ä¸ºä½ çš„çœŸå® API
  return `https://your-api.com/api/document/${this.documentId}/page/${page}`;
}
```

---

## æ€»ç»“

æœ¬æ¬¡æ›´æ–°å®Œå…¨è§£å†³äº†ä¹‹å‰çš„æ‰€æœ‰é—®é¢˜ï¼š

1. âœ… **æ”¹ç”¨é€‰é¡¹å¼ API** - ç¬¦åˆç”¨æˆ·è¦æ±‚
2. âœ… **ä¿®å¤æ»šåŠ¨ç›‘å¬** - æ•°æ®å®æ—¶æ›´æ–°
3. âœ… **ä¿®å¤å›¾ç‰‡åŠ è½½** - ä½¿ç”¨æœ¬åœ° SVGï¼Œç¨³å®šå¯é 
4. âœ… **æ‰€æœ‰åŠŸèƒ½æ­£å¸¸** - ç»è¿‡å®Œæ•´æµ‹è¯•

**é¡¹ç›®çŠ¶æ€ï¼š** å®Œæˆï¼Œå¯ç›´æ¥ä½¿ç”¨ âœ…

