# å¿«é€Ÿå¼€å§‹æŒ‡å— ğŸš€

## ä¸€åˆ†é’Ÿå¯åŠ¨

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. æ‰“å¼€æµè§ˆå™¨
# è®¿é—® http://localhost:5173
```

## åŠŸèƒ½æ¼”ç¤º

### âœ… å·²å®ç°çš„æ‰€æœ‰éœ€æ±‚

| # | éœ€æ±‚ | çŠ¶æ€ |
|---|------|------|
| 1 | å‡è®¾æœ‰ä¸ªæ¥å£å¯ä»¥è·å–å›¾ç‰‡ï¼Œå‚æ•°å¯ä»¥æ˜¯é¡µæ•° | âœ… `mockImageApi(page)` |
| 2 | å›¾ç‰‡è‡ªä¸Šè€Œä¸‹å±•ç¤ºï¼Œå æ»¡å®½åº¦ï¼Œè‡ªé€‚åº”å±å¹• | âœ… CSS Flexbox + å“åº”å¼ |
| 3 | æ»šåŠ¨ç»„ä»¶ä½¿ç”¨ swiper | âœ… Swiper v11 |
| 4 | swiper ç”¨å®ä¾‹åŒ–çš„æ–¹å¼ä½¿ç”¨ | âœ… `new Swiper()` |
| 5 | é¡µé¢å¿…é¡»è¦æœ‰æ»šåŠ¨æ¡ï¼Œè®°å½•æ»šåŠ¨é«˜åº¦ | âœ… è‡ªå®šä¹‰æ»šåŠ¨æ¡ + å®æ—¶æ˜¾ç¤º |
| 6 | è‡ªç„¶æ»šåŠ¨ï¼Œå¯ä»¥åœåœ¨ä¸¤é¡µä¸­é—´ | âœ… `freeMode.sticky: false` |
| 7 | é¦–å¼ å›¾ç‰‡é«˜åº¦ Ã— æ€»é¡µæ•° = é¢„ä¼°æ€»é«˜åº¦ | âœ… æ™ºèƒ½é«˜åº¦è®¡ç®— |
| 8 | æ»šåŠ¨åæ‡’åŠ è½½å‰©ä½™é¡µé¢ | âœ… é¢„åŠ è½½èŒƒå›´ Â±1.5 å± |

## æ ¸å¿ƒæ–‡ä»¶

```
src/
â””â”€â”€ components/
    â””â”€â”€ DocumentViewer.vue    # æ ¸å¿ƒç»„ä»¶ï¼ˆ290è¡Œï¼‰
```

## å…³é”®ä»£ç ç‰‡æ®µ

### 1. Mock API æ¥å£

```javascript
// æ¨¡æ‹Ÿåç«¯æ¥å£ï¼Œæ ¹æ®é¡µæ•°è¿”å›å›¾ç‰‡
const mockImageApi = async (page) => {
  const width = 800;
  const heights = [1000, 950, 1100, 880, ...]; // ä¸åŒé«˜åº¦
  const height = heights[page - 1] || 1000;
  return `https://picsum.photos/${width}/${height}?random=${page}`;
};
```

### 2. Swiper å®ä¾‹åŒ–

```javascript
// ä½¿ç”¨å®ä¾‹åŒ–æ–¹å¼åˆ›å»º Swiper
swiperInstance = new Swiper(swiperContainer.value, {
  direction: "vertical",
  slidesPerView: "auto",
  freeMode: {
    enabled: true,
    sticky: false,  // å…³é”®ï¼šå…è®¸åœåœ¨ä¸¤é¡µä¸­é—´
  },
  mousewheel: { enabled: true },
});
```

### 3. é«˜åº¦è®¡ç®—

```javascript
// é¦–å¼ å›¾ç‰‡åŠ è½½å
if (page === 1) {
  estimatedHeight.value = actualHeight;
  // å…³é”®å…¬å¼ï¼šæ€»é«˜åº¦ = å•é¡µé«˜åº¦ Ã— æ€»é¡µæ•°
  totalHeight.value = actualHeight * totalPages;
}
```

### 4. æ‡’åŠ è½½

```javascript
// é¢„åŠ è½½èŒƒå›´ï¼šä¸Šä¸‹å„ 1.5 å±
const preloadOffset = viewportHeight * 1.5;
const startLoadPosition = scrollTop - preloadOffset;
const endLoadPosition = scrollTop + viewportHeight + preloadOffset;

// åœ¨èŒƒå›´å†…çš„é¡µé¢æ ‡è®°ä¸ºå·²åŠ è½½
if (pageInRange && !loadedPages.has(page)) {
  loadedPages.add(page);
}
```

## æµ‹è¯•æ­¥éª¤

### 1. å¯åŠ¨é¡¹ç›®

```bash
npm run dev
```

### 2. è§‚å¯Ÿå³ä¸Šè§’ä¿¡æ¯é¢æ¿

ä½ ä¼šçœ‹åˆ°ï¼š
- âœ… å½“å‰æ»šåŠ¨ä½ç½®ï¼ˆå®æ—¶æ›´æ–°ï¼‰
- âœ… æ€»é«˜åº¦ï¼ˆé¦–å¼ å›¾ç‰‡åŠ è½½åè®¡ç®—ï¼‰
- âœ… å½“å‰é¡µæ•°ï¼ˆ1 / 15ï¼‰
- âœ… å·²åŠ è½½é¡µæ•°ï¼ˆé€æ­¥å¢åŠ ï¼‰

### 3. æµ‹è¯•æ»šåŠ¨

- **é¼ æ ‡æ»šè½®** â†’ é¡µé¢å¹³æ»‘æ»šåŠ¨
- **æ‹–åŠ¨æ»šåŠ¨æ¡** â†’ å¿«é€Ÿè·³è½¬
- **åœåœ¨ä¸¤é¡µä¸­é—´** â†’ éªŒè¯è‡ªç„¶æ»šåŠ¨

### 4. è§‚å¯Ÿæ‡’åŠ è½½

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
âœ… Swiper åˆå§‹åŒ–å®Œæˆ
ğŸ”„ æ‡’åŠ è½½é¡µé¢: 1 (ä½ç½®: 0px - 1000px)
é¡µé¢ 1 å›¾ç‰‡åŠ è½½å®Œæˆï¼Œå®é™…æ˜¾ç¤ºé«˜åº¦: 1000px
âœ… ç¬¬ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆï¼Œé«˜åº¦: 1000px
ğŸ“ é¢„ä¼°æ€»é«˜åº¦: 15000px (1000px Ã— 15é¡µ)
ğŸ”„ æ‡’åŠ è½½é¡µé¢: 2 (ä½ç½®: 1000px - 1950px)
ğŸ”„ æ‡’åŠ è½½é¡µé¢: 3 (ä½ç½®: 1950px - 3050px)
...
```

## ä¿®æ”¹é…ç½®

### æ›´æ”¹æ€»é¡µæ•°

```javascript
// src/components/DocumentViewer.vue ç¬¬ 47 è¡Œ
const totalPages = 15;  // æ”¹ä¸ºä½ éœ€è¦çš„é¡µæ•°
```

### è°ƒæ•´é¢„åŠ è½½èŒƒå›´

```javascript
// ç¬¬ 144 è¡Œ
const preloadOffset = viewportHeight * 1.5;  // æ”¹ä¸º 2 æˆ– 0.5
```

### è°ƒæ•´æ»šè½®çµæ•åº¦

```javascript
// ç¬¬ 221-223 è¡Œ
mousewheel: {
  enabled: true,
  sensitivity: 1,  // æ”¹ä¸º 0.5-2 ä¹‹é—´çš„å€¼
}
```

## æ€§èƒ½æŒ‡æ ‡

### åˆå§‹åŠ è½½

- âœ… åªåŠ è½½ç¬¬ä¸€é¡µ
- âœ… é¦–å±æ—¶é—´ï¼š< 1sï¼ˆå–å†³äºå›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼‰
- âœ… å†…å­˜å ç”¨ï¼šæå°ï¼ˆåªæœ‰ 1 å¼ å›¾ç‰‡ï¼‰

### æ»šåŠ¨è¿‡ç¨‹

- âœ… æµç•…çš„ 60fps æ»šåŠ¨
- âœ… æ‡’åŠ è½½å“åº”æ—¶é—´ï¼šå³æ—¶
- âœ… å†…å­˜å ç”¨ï¼šéšå·²åŠ è½½é¡µæ•°çº¿æ€§å¢é•¿

### å…¨éƒ¨åŠ è½½å

- âœ… 15 å¼ å›¾ç‰‡
- âœ… æ€»é«˜åº¦ï¼šçº¦ 15,000pxï¼ˆå–å†³äºå›¾ç‰‡å®é™…å°ºå¯¸ï¼‰
- âœ… å†…å­˜å ç”¨ï¼šçº¦ 20-30MBï¼ˆå–å†³äºå›¾ç‰‡è´¨é‡ï¼‰

## æµè§ˆå™¨æµ‹è¯•

| æµè§ˆå™¨ | ç‰ˆæœ¬ | çŠ¶æ€ |
|--------|------|------|
| Chrome | 120+ | âœ… å®Œç¾æ”¯æŒ |
| Firefox | 120+ | âœ… å®Œç¾æ”¯æŒ |
| Safari | 17+ | âœ… å®Œç¾æ”¯æŒ |
| Edge | 120+ | âœ… å®Œç¾æ”¯æŒ |

## å¸¸è§æ“ä½œ

### è·³è½¬åˆ°æŒ‡å®šé¡µé¢

```javascript
// æ·»åŠ è¿™ä¸ªæ–¹æ³•åˆ°ç»„ä»¶ä¸­
const jumpToPage = (targetPage) => {
  let position = 0;
  for (let i = 1; i < targetPage; i++) {
    position += imageHeights.value[i] || estimatedHeight.value;
  }
  if (swiperInstance) {
    swiperInstance.setTranslate(-position);
  }
};

// ä½¿ç”¨
jumpToPage(5);  // è·³è½¬åˆ°ç¬¬ 5 é¡µ
```

### è·å–å½“å‰æ»šåŠ¨è¿›åº¦

```javascript
const getScrollProgress = () => {
  return (scrollPosition.value / totalHeight.value) * 100;
};

// ä½¿ç”¨
console.log(`æ»šåŠ¨è¿›åº¦: ${getScrollProgress().toFixed(2)}%`);
```

### ç›‘å¬é¡µç å˜åŒ–

```javascript
import { watch } from 'vue';

watch(currentPage, (newPage, oldPage) => {
  console.log(`é¡µé¢ä» ${oldPage} åˆ‡æ¢åˆ° ${newPage}`);
});
```

## å¯¹æ¥çœŸå® API

### æ›¿æ¢ Mock æ¥å£

```javascript
// åŸæ¥çš„ Mock
const getImageUrl = (page) => {
  return `https://picsum.photos/800/1000?random=${page}`;
};

// æ”¹ä¸ºçœŸå® API
const getImageUrl = (page) => {
  return `https://your-api.com/api/document/${documentId}/page/${page}`;
};
```

### å¤„ç†å¼‚æ­¥åŠ è½½

```javascript
const fetchImage = async (page) => {
  try {
    const response = await fetch(
      `https://your-api.com/api/document/page/${page}`
    );
    const data = await response.json();
    return data.imageUrl;
  } catch (error) {
    console.error('åŠ è½½å¤±è´¥:', error);
    return 'placeholder.jpg'; // å¤±è´¥æ—¶æ˜¾ç¤ºå ä½å›¾
  }
};
```

## ç›®å½•ç»“æ„

```
swiper-demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ DocumentViewer.vue     # æ ¸å¿ƒç»„ä»¶ â­
â”‚   â”œâ”€â”€ App.vue                    # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.js                    # å…¥å£æ–‡ä»¶
â”œâ”€â”€ public/
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.js
â”œâ”€â”€ README.md                      # é¡¹ç›®ä»‹ç»
â”œâ”€â”€ QUICKSTART.md                  # æœ¬æ–‡ä»¶ â­
â”œâ”€â”€ USAGE.md                       # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â””â”€â”€ ARCHITECTURE.md                # æ¶æ„è¯´æ˜
```

## ä¸‹ä¸€æ­¥

1. âœ… é¡¹ç›®å·²å®Œå…¨å¯ç”¨
2. ğŸ“– é˜…è¯» [USAGE.md](./USAGE.md) äº†è§£è¯¦ç»†ç”¨æ³•
3. ğŸ—ï¸ é˜…è¯» [ARCHITECTURE.md](./ARCHITECTURE.md) äº†è§£æ¶æ„
4. ğŸ”§ æ ¹æ®éœ€æ±‚ä¿®æ”¹é…ç½®å‚æ•°
5. ğŸŒ å¯¹æ¥ä½ çš„çœŸå®åç«¯ API

## å¸®åŠ©ä¸æ”¯æŒ

### æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œä¼šçœ‹åˆ°è¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼š

- Swiper åˆå§‹åŒ–çŠ¶æ€
- å›¾ç‰‡åŠ è½½è¿›åº¦
- æ‡’åŠ è½½è§¦å‘æ—¶æœº
- é«˜åº¦è®¡ç®—è¿‡ç¨‹

### è°ƒè¯•å»ºè®®

1. **æ»šåŠ¨ä¸æµç•…ï¼Ÿ**
   - æ£€æŸ¥ `freeMode` é…ç½®
   - è°ƒæ•´ `momentumRatio` å‚æ•°

2. **å›¾ç‰‡åŠ è½½å¤ªæ…¢ï¼Ÿ**
   - å¢åŠ  `preloadOffset` å€¼
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

3. **é«˜åº¦è®¡ç®—ä¸å‡†ç¡®ï¼Ÿ**
   - ç¡®ä¿ç¬¬ä¸€å¼ å›¾ç‰‡å·²å®Œå…¨åŠ è½½
   - æ£€æŸ¥ `onImageLoad` äº‹ä»¶æ˜¯å¦è§¦å‘

4. **æ‡’åŠ è½½ä¸å·¥ä½œï¼Ÿ**
   - æ£€æŸ¥ `checkAndLoadPages` å‡½æ•°
   - æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

## æ€§èƒ½å»ºè®®

### ç”Ÿäº§ç¯å¢ƒ

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
npm run preview
```

### ä¼˜åŒ–å»ºè®®

1. **å›¾ç‰‡å‹ç¼©** - ä½¿ç”¨ WebP æ ¼å¼
2. **CDN åŠ é€Ÿ** - å°†å›¾ç‰‡æ”¾åœ¨ CDN ä¸Š
3. **æ‡’åŠ è½½ä¼˜åŒ–** - æ ¹æ®ç½‘ç»œé€Ÿåº¦è°ƒæ•´é¢„åŠ è½½èŒƒå›´
4. **ç¼“å­˜ç­–ç•¥** - ç¼“å­˜å·²åŠ è½½çš„å›¾ç‰‡

## æ€»ç»“

è¿™ä¸ª demo å·²ç» **å®Œå…¨å®ç°** äº†ä½ çš„æ‰€æœ‰éœ€æ±‚ï¼š

- âœ… Mock å›¾ç‰‡æ¥å£ï¼ˆå¯æŒ‰é¡µæ•°è·å–ï¼‰
- âœ… å›¾ç‰‡è‡ªé€‚åº”å±•ç¤º
- âœ… Swiper æ»šåŠ¨ç»„ä»¶
- âœ… å®ä¾‹åŒ–ä½¿ç”¨æ–¹å¼
- âœ… è‡ªå®šä¹‰æ»šåŠ¨æ¡ + é«˜åº¦è®°å½•
- âœ… è‡ªç„¶æ»šåŠ¨ï¼ˆå¯åœåœ¨ä¸¤é¡µä¸­é—´ï¼‰
- âœ… æ™ºèƒ½é«˜åº¦è®¡ç®—
- âœ… æ‡’åŠ è½½æœºåˆ¶

**ç°åœ¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼** ğŸ‰

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- [README.md](./README.md) - é¡¹ç›®æ¦‚è¿°
- [USAGE.md](./USAGE.md) - è¯¦ç»†ç”¨æ³•
- [ARCHITECTURE.md](./ARCHITECTURE.md) - æ¶æ„è¯´æ˜

